import{j as e,r as u,a as Le}from"./react-5eb0e449.js";import{c as Oe}from"./react-dom-b1be8f91.js";import{L as M,B as $e}from"./react-router-dom-13c3b58f.js";import{u as N,a as f,P as De}from"./react-redux-653d053b.js";import{a as y}from"./axios-82afda87.js";import{c as E,a as ke}from"./@reduxjs-78facea8.js";import{s as Ue,t as T,a as v,p as m,b as R}from"./@redux-saga-89c120ef.js";import"./hoist-non-react-statics-23d96a9a.js";import{B as Pe,A as Fe,C as Ge,T as Ae,E as qe,a as Be}from"./@heroicons-10d64fe1.js";import{d as X,a as Ve,e as He,f as I,g as ze}from"./react-router-ccc50324.js";import{_ as Ye}from"./3dmol-9b08ddb0.js";import{m as We,O as z}from"./openchemlib-3dc7d383.js";import"./scheduler-765c72db.js";import"./@remix-run-d753ad9e.js";import"./use-sync-external-store-5dc28ea7.js";import"./immer-41fd5235.js";import"./redux-45c81fac.js";import"./@babel-d426c579.js";import"./redux-thunk-ef899f4c.js";import"./react-is-e8e5dbb3.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function Q(t,s,n){return o=>{o.stopPropagation(),s.includes(t)?n(s.filter(r=>r!==t)):n([...s,t])}}function F(t,s,n){return(o=s,r=n)=>t?o:r}function ee(t){return t.replace(/\./g," + ").replace(">>"," >> ")}function Y(t){return e.jsx("span",{className:"capitalize",children:t})}function G(t){return e.jsx(e.Fragment,{children:t&&t.split(/(\d+)/).map((s,n)=>s.match(/^\d+$/)?e.jsx("sub",{children:s},n):e.jsx("span",{children:s},n))})}function C(t){t.response.status===401&&alert("You are not authorized to make this request. Are you logged in?"),console.error(t)}const A=E({name:"user",initialState:null,reducers:{setUser:(t,s)=>s.payload,unsetUser:()=>null}}),Ze=A.actions.setUser,Je=A.actions.unsetUser,Ke=A.reducer,_=E({name:"error",initialState:"",reducers:{setLoginError:()=>"Your credentials were not accepted. Please try again.",setRegistrationError:()=>"This email is already registered. Please log in instead.",setRetypeError:()=>"The re-typed password does not match. Please try again.",setCodelessError:()=>"Something isn't right on the server...",clearError:()=>""}}),Xe=_.actions.setLoginError,Qe=_.actions.setRegistrationError,et=_.actions.setRetypeError,te=_.actions.setCodelessError,se=_.actions.clearError,tt=_.reducer,oe=E({name:"species",initialState:[],reducers:{setSpecies:(t,s)=>s.payload}}),st=oe.actions.setSpecies,ot=oe.reducer,ne=E({name:"speciesDetails",initialState:{},reducers:{addSpeciesDetails:(t,s)=>({...t,...s.payload})}}),nt=ne.actions.addSpeciesDetails,rt=ne.reducer,re=E({name:"reactions",initialState:[],reducers:{setReactions:(t,s)=>s.payload}}),at=re.actions.setReactions,it=re.reducer,ae=E({name:"reactionDetails",initialState:{},reducers:{addReactionDetails:(t,s)=>({...t,...s.payload})}}),ct=ae.actions.addReactionDetails,lt=ae.reducer,ie=E({name:"reactionMode",initialState:!1,reducers:{setReactionMode:(t,s)=>s.payload}}),dt=ie.actions.setReactionMode,ut=ie.reducer,q=E({name:"submissions",initialState:[],reducers:{addSubmission:(t,s)=>[...t,s.payload],updateSubmission:(t,s)=>{const{index:n,update:o}=s.payload;return t.map((r,a)=>a===n?{...r,...o}:r)}}}),mt=q.actions.addSubmission,W=q.actions.updateSubmission,pt=q.reducer,ce=E({name:"collections",initialState:[],reducers:{setCollections:(t,s)=>s.payload}}),xt=ce.actions.setCollections,ht=ce.reducer,le=Ue(),ft=ke({reducer:{user:Ke,error:tt,species:ot,speciesDetails:rt,reactions:it,reactionDetails:lt,reactionMode:ut,submissions:pt,collections:ht},middleware:t=>t().concat(le)}),de="GET_USER";function*gt(){try{const s=yield(yield y.get("/api/@me")).data;yield m(Ze(s.contents))}catch(t){console.error(t)}}const B=()=>({type:de}),ue="LOGIN_USER";function*yt(t){try{yield m(se());const s=yield y.post("/api/login",t.payload);yield m(B())}catch(s){console.error(s),s.response.status===401?yield m(Xe()):yield m(te())}}const jt=t=>({type:ue,payload:t}),me="LOGOUT_USER";function*bt(){try{const t=yield y.post("/api/logout");yield m(Je())}catch(t){console.error(t)}}const St=()=>({type:me}),pe="REGISTER_USER";function*wt(t){try{yield m(se());const s=yield y.post("/api/register",t.payload);yield m(B())}catch(s){console.error(s),s.response.status===409?yield m(Qe()):yield m(te())}}const Nt=t=>({type:pe,payload:t}),xe="GET_SPECIES";function*Et(t){try{let s="/api/species/connectivity";if(t.payload&&t.payload.formula){const r=t.payload.formula,a=t.payload.partial?"partial":"";s+=`?formula=${r}&${a}`}const o=yield(yield y.get(s)).data;yield m(st(o.contents))}catch(s){console.error(s)}}const V=t=>({type:xe,payload:t}),he="GET_REACTIONS";function*vt(t){try{let s="/api/reaction/connectivity";if(t.payload&&t.payload.formula){const r=t.payload.formula,a=t.payload.partial?"partial":"";s+=`?formula=${r}&${a}`}const o=yield(yield y.get(s)).data;yield m(at(o.contents))}catch(s){console.error(s)}}const H=t=>({type:he,payload:t}),fe="GET_DETAILS";function*Ct(t){try{const s=yield R(i=>i.reactionMode),n=s?"reaction":"species",o=t.payload,a=yield(yield y.get(`/api/${n}/connectivity/${o}`)).data;s?yield m(ct({[o]:a.contents})):yield m(nt({[o]:a.contents}))}catch(s){console.error(s)}}const ge=t=>({type:fe,payload:t}),ye="DELETE_ITEM";function*Tt(t){const s=yield R(o=>o.reactionMode),n=s?"reaction":"species";try{const o=t.payload;yield y.delete(`/api/${n}/connectivity/${o}`),yield m(s?H():V())}catch(o){C(o)}}const It=t=>({type:ye,payload:t}),je="UPDATE_ITEM_GEOMETRY";function*Mt(t){const n=(yield R(o=>o.reactionMode))?"reaction/ts":"species";try{const o=t.payload.connId,r=t.payload.id;yield y.put(`/api/${n}/${r}`,t.payload),yield m(ge(o))}catch(o){C(o)}}const Rt=t=>({type:je,payload:t}),be="POST_SUBMISSION";function*_t(t){const n=(yield R(i=>i.submissions)).length;let{smiles:o,isReaction:r}=t.payload,a={smiles:o,isReaction:r,status:"Submitted"};yield m(mt(a));try{const i=`/api/${r?"reaction":"species"}/connectivity`;o=o.replace(/\s+\+\s+/g,".").replace(/\s+/g,"");const c=yield y.post(i,{smiles:o});console.log("response:",c),a={...a,status:"Complete"},yield m(W({index:n,update:a})),yield m(r?H():V())}catch(i){C(i),a={...a,status:"Error",message:i.response.data.error},console.log(i),yield m(W({index:n,update:a}))}}const Lt=t=>({type:be,payload:t}),Se="GET_COLLECTIONS";function*Ot(){try{const s=yield(yield y.get("/api/collection")).data;yield m(xt(s.contents))}catch(t){C(t)}}const L=()=>({type:Se}),we="POST_NEW_COLLECTION";function*$t(t){try{yield y.post("/api/collection",t.payload),yield m(L())}catch(s){C(s)}}const Dt=t=>({type:we,payload:t}),Ne="POST_COLLECTION_ITEMS";function*kt(t){const n=(yield R(o=>o.reactionMode))?"reaction":"species";try{const o=t.payload.coll_id;console.log(`Posting to /api/collection/${n}/${o} with payload`,t.payload),yield y.post(`/api/collection/${n}/${o}`,t.payload),yield m(L())}catch(o){C(o)}}const Ut=t=>({type:Ne,payload:t}),Ee="DELETE_COLLECTION_ITEMS";function*Pt(t){const n=(yield R(o=>o.reactionMode))?"reaction":"species";try{const o=t.payload.coll_id;console.log(`Deleting from /api/collection/${n}/${o} with payload`,t.payload),yield y.delete(`/api/collection/${n}/${o}`,{data:t.payload}),yield m(L())}catch(o){C(o)}}const Ft=t=>({type:Ee,payload:t}),ve="DELETE_COLLECTION";function*Gt(t){try{const s=t.payload.coll_id;yield y.delete(`/api/collection/${s}`),yield m(L())}catch(s){C(s)}}const At=t=>({type:ve,payload:t});function*qt(){yield T(de,gt),yield T(ue,yt),yield T(me,bt),yield T(pe,wt),yield T(xe,Et),yield T(he,vt),yield v(fe,Ct),yield v(ye,Tt),yield v(je,Mt),yield v(be,_t),yield T(Se,Ot),yield v(we,$t),yield v(Ne,kt),yield v(Ee,Pt),yield v(ve,Gt)}le.run(qt);const x={getUser:B,loginUser:jt,logoutUser:St,registerUser:Nt,getSpecies:V,getReactions:H,getDetails:ge,deleteItem:It,updateItemGeometry:Rt,postSubmission:Lt,getCollections:L,postNewCollection:Dt,postCollectionItems:Ut,deleteCollectionItems:Ft,deleteCollection:At,setRetypeError:et,setReactionMode:dt},Bt="/fire-icon.svg";function Vt(){const t=N(),s=f(n=>n.user);return e.jsxs("nav",{className:"navbar mb-20",children:[e.jsxs("div",{className:"navbar-start gap-6",children:[e.jsx("img",{className:"h-16",src:Bt,alt:"Fire icon"}),e.jsx("div",{className:"text-3xl",children:"FlameData"})]}),e.jsxs("div",{className:"navbar-end",children:[e.jsx("div",{children:s&&s.email}),e.jsxs("div",{className:"dropdown dropdown-end dropdown-hover",children:[e.jsx("label",{tabIndex:0,className:"btn btn-ghost m-1",children:e.jsx(Pe,{className:"h-6 w-6"})}),e.jsxs("ul",{tabIndex:0,className:"menu menu-sm dropdown-content z-[1] p-2 shadow bg-base-100 rounded-box w-32",children:[e.jsx("li",{children:e.jsx(M,{to:"/",children:"Home"})}),s&&e.jsx("li",{children:e.jsx(M,{to:"/submit",children:"Submit"})}),s?e.jsx("li",{children:e.jsx("a",{onClick:()=>t(x.logoutUser()),children:"Log Out"})}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:e.jsx(M,{to:"/login",children:"Log In"})}),e.jsx("li",{children:e.jsx(M,{to:"/login/register",children:"Register"})})]})]})]})]})]})}function Ht({children:t}){return e.jsxs("div",{className:"p-8 min-h[100vh] bg-base-100",children:[e.jsx("header",{children:e.jsx(Vt,{})}),e.jsx("main",{className:"flex flex-col justify-center items-center",children:t})]})}function zt(){const t=N(),s=f(b=>b.error),[n,o]=u.useState(!1),[r,a]=u.useState(""),[i,c]=u.useState(""),[l,p]=u.useState(""),{mode:j}=X();u.useEffect(()=>{o(j=="register")},[j]);const g=()=>{t(i!==l?x.retypeError():x.registerUser({email:r,password:i}))},S=()=>{t(x.loginUser({email:r,password:i}))};return e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"flex flex-col gap-2 w-fit",children:[e.jsx("div",{className:"self-end mb-6",children:e.jsxs("label",{className:"flex gap-2 justify-between items-end label cursor-pointer w-full ",children:[n?e.jsx("span",{className:"label-text",children:"I have an account"}):e.jsx("span",{className:"label-text",children:"I need an account"}),e.jsx("input",{type:"checkbox",className:"toggle",checked:n,onChange:()=>o(!n)})]})}),e.jsx("input",{required:!0,type:"text",placeholder:"Email",className:"input input-bordered w-full max-w-xs",value:r,onChange:b=>a(b.target.value)}),e.jsx("input",{required:!0,type:"password",placeholder:"Password",className:"input input-bordered w-full max-w-xs",value:i,onChange:b=>c(b.target.value)}),n?e.jsxs(e.Fragment,{children:[e.jsx("input",{required:!0,type:"password",placeholder:"Re-type password",className:"input input-bordered w-full max-w-xs",value:l,onChange:b=>p(b.target.value)}),e.jsx("button",{className:"btn btn-outline mb-4 self-end",onClick:g,children:"Register"})]}):e.jsx("button",{className:"btn btn-outline mb-4 self-end",onClick:S,children:"Log In"})]}),e.jsx("div",{children:s})]})}function Ce({text1:t,text2:s,selection:n,setSelection:o,vertical:r=!0,selectionFor:a=1,className:i=""}){const c=()=>a===1?n:!n;return i=`${r?"flex flex-col gap-2":"flex flex-row gap-12"} ${i}`,e.jsxs("div",{className:i,children:[e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("input",{type:"radio",className:"radio",checked:c(),onChange:()=>o(!n)}),e.jsx("div",{className:c()?"":"text-neutral",children:t})]}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx("input",{type:"radio",className:"radio",checked:!c(),onChange:()=>o(!n)}),e.jsx("div",{className:c()?"text-neutral":"",children:s})]})]})}function Te(){const t=N(),s=f(o=>o.reactionMode),n=o=>{t(x.setReactionMode(o))};return e.jsx(Ce,{text1:"Species",text2:"Reaction",vertical:!1,selection:s,setSelection:n,selectionFor:2,className:"mb-12"})}function D({children:t,withCheckbox:s=!1,checked:n=!1,checkHandler:o=()=>{},className:r="h-96 aspect-square",checkboxClassNames:a="checkbox-primary checkbox-sm"}){return r=`relative bg-white flex flex-col justify-center items-center rounded-3xl ${r}`,r.includes("aspect")||(r+=" aspect-square"),e.jsxs("div",{className:r,children:[t,s&&e.jsx("input",{readOnly:!0,type:"checkbox",checked:n,onClick:o,className:`checkbox absolute bottom-2 right-2 ${a}`})]})}function Ie({svgString:t,descriptors:s=[],hoverText:n="",withCheckbox:o=!1,checked:r=!1,checkHandler:a=()=>{},className:i="h-96",checkboxClassNames:c="checkbox-primary checkbox-sm"}){return e.jsx(D,{withCheckbox:o,checked:r,checkHandler:a,checkboxClassNames:c,className:i,children:t&&e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"h-3/4 rounded-3xl",src:`data:image/svg+xml;utf8,${encodeURIComponent(t)}`,title:n}),s.map((l,p)=>e.jsx("div",{className:"text-neutral text-lg",children:l},p))]})})}function Yt({reactantsSvgString:t,productsSvgString:s,descriptors:n=[],hoverText:o="",withCheckbox:r=!1,checked:a=!1,checkHandler:i=()=>{},className:c="h-96",checkboxClassNames:l="checkbox-primary checkbox-sm"}){const p=n.length?"h-3/4":"h-full";return e.jsx(D,{withCheckbox:r,checked:a,checkHandler:i,checkboxClassNames:l,className:c,children:t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`relative w-full flex flex-col justify-between items-center ${p}`,children:[e.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(t)}`,className:"p-2 h-1/2 max-w-full rounded-3xl"}),e.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(s)}`,className:"p-2 h-1/2 max-w-full rounded-3xl"}),e.jsx("div",{className:"w-full h-full absolute inset-0 top-1/2 left-1/2",children:e.jsx(Fe,{className:"text-neutral h-5 -translate-y-1/2 -translate-x-1/2"})})]}),n.map((j,g)=>e.jsx("div",{className:"text-neutral text-lg",children:j},g))]})})}function Me({item:t,firstInGroup:s=!1,withCheckbox:n=!1,checked:o=!1,checkHandler:r=()=>{},className:a="m-4 w-44",checkboxClassNames:i="checkbox-primary checkbox-sm"}){const c=f(l=>l.reactionMode);return e.jsxs("div",{children:[s&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"text-neutral rotate-45 h-6"}),e.jsx("div",{className:"pl-6 text-neutral",children:G(t.formula)})]}),c?e.jsx(M,{to:`/reaction/details/${t.id}`,children:e.jsx(Yt,{reactantsSvgString:t.r_svg_string,productsSvgString:t.p_svg_string,className:a,hoverText:t.conn_smiles,withCheckbox:n,checked:o,checkHandler:r,checkboxClassNames:i})}):e.jsx(M,{to:`/species/details/${t.id}`,children:e.jsx(Ie,{svgString:t.svg_string,className:a,hoverText:t.conn_smiles,withCheckbox:n,checked:o,checkHandler:r,checkboxClassNames:i})})]})}function Wt({itemList:t,selectedItems:s,setSelectedItems:n,className:o=""}){const r=f(c=>c.user);let a=[],i="";for(const c of t)a.push([c,c.formula!==i]),i=c.formula;return e.jsx("div",{className:`flex flex-wrap gap-8 justify-start items-end pb-24 ${o}`,children:a.map(([c,l],p)=>e.jsx(Me,{item:c,firstInGroup:l,withCheckbox:r,checked:s.includes(c.id),checkHandler:Q(c.id,s,n)},p))})}function Re({warningMessage:t,handleDelete:s,id:n=0}){const o=`dialog${n}`,r=document.getElementById(o);return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-error btn-outline btn-square self-end",onClick:()=>r.showModal(),children:e.jsx(Ae,{className:"p-2"})}),e.jsx("dialog",{id:o,className:"modal",children:e.jsxs("form",{method:"dialog",className:"modal-box",children:[e.jsx(qe,{className:"mb-4 h-8 w-8 text-error"}),e.jsx("h3",{className:"text-lg",children:t}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{className:"btn",children:"No"}),e.jsx("button",{className:"btn btn-error",onClick:s,children:"Yes"})]})]})})]})}const Zt=(t,s="data")=>{const n=new Blob([JSON.stringify(t)],{type:"text/json"}),o=document.createElement("a");o.download=`${s.replace(/ /g,"_")}.json`,o.href=window.URL.createObjectURL(n);const r=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(r),o.remove()};function Jt({collections:t,selectedCollection:s,setSelectedCollection:n}){const o=N(),r=f(d=>d.reactionMode),[a,i]=u.useState([]),[c,l]=u.useState(""),p=r?"reactions":"species",j=d=>()=>{n(d)},g=()=>{const d={name:c};o(x.postNewCollection(d)),l("")},S=d=>()=>{const w={coll_id:d.id};o(x.deleteCollection(w))},b=()=>{const d={coll_id:s,conn_ids:a};o(x.deleteCollectionItems(d)),i([])},O=d=>async()=>{try{const k=await(await y.get(`/api/collection/${d.id}`)).data;Zt(k,d.name)}catch(w){alert("Something went wrong with the download..."),console.error(w)}};return e.jsxs("aside",{className:"sticky top-12 join join-vertical max-w-lg h-screen pb-24",children:[t.map(d=>e.jsxs("div",{className:"collapse join-item border border-primary",children:[e.jsx("input",{type:"radio",name:"my-accordion-2",checked:d.id===s,onChange:j(d.id)}),e.jsx("div",{className:"collapse-title flex flex-row justify-between text-xl text-primary font-medium",children:d.name}),e.jsxs("div",{className:"collapse-content flex flex-col gap-4 justify-center items-center",children:[e.jsx("div",{className:"flex flex-wrap justify-start overflow-x-hidden overflow-y-auto",children:d[p]&&d[p].map(w=>e.jsx(Me,{item:w,className:"m-2 w-32",withCheckbox:!0,checked:a.includes(w.id),checkHandler:Q(w.id,a,i),checkboxClassNames:"checkbox-warning checkbox-sm"},w.id))}),e.jsxs("div",{className:"w-full flex flex-row justify-start gap-4",children:[d[p]&&d[p].length>0&&e.jsx("button",{onClick:O(d),className:"btn btn-outline btn-secondary",children:"Download"}),a.length>0&&e.jsx("button",{onClick:b,className:"btn btn-outline btn-warning",children:"Remove"}),e.jsx("div",{className:"ml-auto",children:d.name!=="My Data"&&e.jsx(Re,{warningMessage:`Are you sure? This will remove '${d.name}' from your collections.`,handleDelete:S(d),id:d.id})})]})]})]},d.id)),e.jsxs("div",{className:"flex flex-row justify-center items-center w-full outline outline-primary outline-1 rounded-t-none rounded-b-lg",children:[e.jsx("button",{onClick:g,className:"grow btn rounded-none rounded-bl-lg",children:"New Collection"}),e.jsx("input",{type:"text",placeholder:"Enter name...",value:c,onChange:d=>l(d.target.value),className:"grow input rounded-none rounded-br-lg text-white input-bordered w-full max-w-xs"})]})]})}function $({condition:t,text:s,onClick:n,className:o="btn-primary bottom-4 left-4"}){return o=`btn m-1 fixed ${o}`,t&&e.jsx("button",{onClick:n,className:o,children:s})}function Kt(){const t=N(),s=f(h=>h.user),n=f(h=>h.collections),o=f(h=>h.reactionMode),[r,a]=u.useState([]),[i,c]=u.useState(null),[l,p]=u.useState(""),[j,g]=u.useState(!1),[S,b]=u.useState(!1),O=f(h=>o?h.reactions:h.species);u.useEffect(()=>{t(x.getSpecies()),t(x.getReactions())},[]),u.useEffect(()=>{s&&t(x.getCollections())},[s]),u.useEffect(()=>{i===null&&n.length>0&&c(n[0].id)},[n]);const d=()=>{const h={formula:l,partial:j};o?(t(x.getReactions(h)),t(x.getSpecies(h))):(t(x.getSpecies(h)),t(x.getReactions(h))),p(""),b(!0)},w=()=>{t(o?x.getReactions():x.getSpecies()),p(""),b(!1)},k=()=>{a(O.map(h=>h.id))},_e=()=>{const h={coll_id:i,conn_ids:r};t(x.postCollectionItems(h)),a([])};return e.jsxs("div",{className:"flex flex-col gap-6 justify-center items-center",children:[e.jsx(Te,{}),e.jsxs("div",{className:"relative flex flex-row gap-6 mb-12",children:[e.jsxs("div",{className:"w-96 flex flex-col gap-6",children:[e.jsx("input",{type:"text",spellCheck:!1,placeholder:"Search by formula...",className:"input input-bordered w-full max-w-xl mr-2",value:l,onChange:h=>p(h.target.value)}),e.jsx(Ce,{text1:"Partial match",text2:"Exact match",selection:j,setSelection:g})]}),e.jsx("button",{className:"btn btn-outline",onClick:d,children:"Search"})]}),e.jsxs("div",{className:"flex flex-row justify-center gap-12 items-start",children:[e.jsx(Wt,{itemList:O,selectedItems:r,setSelectedItems:a,className:s?"w-2/3":"w-full"}),s&&e.jsx(Jt,{collections:n,selectedCollection:i,setSelectedCollection:c}),e.jsx($,{condition:S,text:"Select All",onClick:k,className:"btn-warning bottom-36 left-4"}),e.jsx($,{condition:S,text:"Clear Search",onClick:w,className:"btn-accent bottom-20 left-4"}),e.jsx($,{condition:r.length>0,text:"Add to Collection",onClick:_e})]})]})}function P({statsList:t,vertical:s=!1,containerClassName:n="shadow",valueClassName:o="text-base"}){return n+=s?" stats-vertical":"",e.jsx("div",{className:`stats ${n}`,children:t.map(([r,a,i],c)=>e.jsxs("div",{className:"stat border-none",children:[e.jsx("div",{className:"stat-title",children:r}),e.jsx("div",{className:`stat-value ${o}`,children:i?i(a):a})]},c))})}function Xt({xyzString:t,className:s="",id:n="species3DView"}){let o=Ye.createViewer(n,{minimumZoomToDistance:3});return u.useEffect(()=>{o&&(console.log("Adding model with this string:"),console.log(t),o.addModel(t,"xyz"),o.setStyle({stick:{},sphere:{radius:.3}}),o.zoomTo(),o.render())},[o]),e.jsx("div",{children:e.jsx(D,{className:s,children:e.jsx("div",{id:n,style:{width:"23rem",height:"23rem",position:"relative"}})})})}function U({geometry:t,connId:s,id:n}){const o=N(),r=f(b=>b.user),[a,i]=u.useState(!1),[c,l]=u.useState(t),p=u.useRef();u.useEffect(()=>{l(p.current.innerText.replace(`


`,`

`))},[a]);const j=()=>{i(!a)},g=()=>{l(t)},S=()=>{o(x.updateItemGeometry({id:n,connId:s,geometry:c})),window.location.reload()};return e.jsxs("div",{className:"mb-6 flex flex-row flex-wrap gap-12 justify-center items-start",children:[e.jsx(Xt,{id:`I${n}`,className:"m-4 w-96",xyzString:c}),e.jsxs("div",{className:"w-min",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("div",{className:"stat-title",children:"Coordinates"}),e.jsxs("div",{className:"flex gap-2",children:[t!=c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-outline btn-sm btn-primary",onClick:g,children:"Restore"}),e.jsx("button",{className:"btn btn-outline btn-sm btn-warning",onClick:S,children:"Submit"})]}),r&&e.jsx("button",{className:"btn btn-outline btn-sm btn-secondary",onClick:j,children:a?"Done":"Edit"})]})]}),e.jsx("div",{ref:p,className:`w-96 max-h-96 m-2 rounded-lg overflow-auto text-base whitespace-pre-wrap font-mono ${a?"outline outline-1 outline-secondary focus:outline-4":""}`,contentEditable:a,suppressContentEditableWarning:!0,children:c})]})]})}function Qt({detailItem:t,isomerIndex:s=0,isomerCount:n=1}){const o=f(i=>i.reactionMode),r=o?t.geometries.length:void 0,a=[];return n>1&&a.push(["Stereoisomer",`${s+1}/${n}`],["SMILES",ee(t.smiles)]),o||a.push(["InChI",t.inchi],["AMChI",t.amchi]),r===1&&a.push(["TS Type",t.classes[0],Y],["TS AMChI",t.amchis[0]]),e.jsxs("div",{className:"mb-6 card bg-base-100 shadow-2xl",children:[e.jsx(P,{statsList:a,containerClassName:"mb-6",valueClassName:"text-base font-normal overflow-x-auto"}),o?r>1?t.geometries.map((i,c)=>e.jsxs(e.Fragment,{children:[e.jsx(P,{statsList:[["TS Structure",`${c+1}/${r}`],["TS Type",t.classes[c],Y],["TS AMChI",t.amchis[c]]],containerClassName:"mb-2 ml-16",valueClassName:"text-base font-normal overflow-x-auto"}),e.jsx(U,{geometry:i,connId:t.conn_id,id:t.ts_ids[c]})]})):e.jsx(U,{geometry:t.geometries[0],connId:t.conn_id,id:t.ts_ids[0]}):e.jsx(U,{geometry:t.geometry,connId:t.conn_id,id:t.id})]})}function Z({isReaction:t}){const{id:s}=X(),n=N(),o=Ve(),r=f(g=>g.user),a=f(g=>g.reactionMode),i=f(g=>a?g.reactionDetails:g.speciesDetails),c=F(a,"reaction","species"),l=i[s],p=[];l&&p.push(["Formula",l[0].formula,G],["SMILES",l[0].conn_smiles,ee],["Spin Multiplicity",l[0].spin_mult]),u.useEffect(()=>{a!==t&&n(x.setReactionMode(t))},[]),u.useEffect(()=>{n(x.getDetails(s))},[]);const j=()=>{n(x.deleteItem(s)),o("/")};return l&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx(P,{statsList:p,containerClassName:"mb-8 shadow-2xl",valueClassName:"text-3xl"}),e.jsx("div",{className:"mb-8 flex flex-col",children:l.map((g,S)=>e.jsx(Qt,{detailItem:g,isomerIndex:S,isomerCount:l.length},S))}),r&&e.jsx(Re,{warningMessage:`Are you sure? This will delete all records for ${c()} ${s}`,handleDelete:j})]})}function J({label:t,example:s,smiles:n,setSmiles:o,className:r=""}){return r=`w-full input input-bordered ${r}`,e.jsxs("div",{children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text",children:["SMILES for ",t]})}),e.jsx("input",{type:"text",spellCheck:!1,placeholder:`${s}`,value:n,onChange:a=>o(a.target.value),className:r})]})}function K({smiles:t,className:s="h-96"}){t=t.replace(/\s+\+\s+/g,".");let n,o;const[r,a]=u.useState(null),i={noStereo:!0},c={autoCrop:!0,autoCropMargin:10,suppressChiralText:!0,noStereoProblem:!0},[l,p]=u.useMemo(()=>{try{return[!0,We.Molecule.fromSmiles(t,i)]}catch(j){return[!1,j]}},[z,t]);return u.useEffect(()=>{l&&a(p)},[z,t]),r&&(n=r.toSVG(400,400,"",c),o=r.getMolecularFormula().formula),e.jsx(Ie,{svgString:n,descriptors:[G(o)],className:s})}function es({smiles1:t,setSmiles1:s,smiles2:n,setSmiles2:o}){const r=f(i=>i.reactionMode),a=F(r,"reaction","species");return e.jsxs("div",{className:"w-fit flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"flex flex-row",children:[e.jsx(J,{label:a("reactants"),example:a("CC + [OH]","CC(O)C"),smiles:t,setSmiles:s,className:a("rounded-r-none","")}),r&&e.jsx(e.Fragment,{children:e.jsx(J,{label:"products",example:"C[CH2] + O",smiles:n,setSmiles:o,className:"rounded-l-none"})})]}),e.jsx(D,{className:`h-96 m-4 ${a("aspect-auto w-fit","aspect-square")}`,children:e.jsxs("div",{className:"w-full flex flex-row justify-center items-center",children:[e.jsx(K,{smiles:t,className:`h-96 ${a("h-80 aspect-[2/3]","h-96 aspect-square")}`}),r&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"text-black w-12"}),e.jsx(K,{smiles:n,className:"h-96 aspect-[2/3]"})]})]})})]})}function ts(){N();const t=f(s=>s.submissions);return e.jsx("div",{children:e.jsxs("table",{className:"table table-auto shadow-2xl overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Submission"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[t.map((s,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.smiles}),e.jsx("td",{children:s.status})]},n)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"This table will show the status of your submissions..."})})]})]})})}function ss(){const t=N(),[s,n]=u.useState(""),[o,r]=u.useState(""),a=f(l=>l.reactionMode),i=F(a,"reaction","species"),c=()=>{let l;a?l=s+" >> "+o:l=s,t(x.postSubmission({smiles:l,isReaction:a})),n(""),r("")};return e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx(Te,{}),e.jsxs("h2",{className:"mb-12",children:["Enter the ",i()," you want to add below..."]}),e.jsxs("div",{className:"flex flex-row justify-center gap-24",children:[e.jsx("div",{className:"flex flex-row gap-6",children:e.jsx(es,{smiles1:s,setSmiles1:n,smiles2:o,setSmiles2:r})}),e.jsx(ts,{})]}),e.jsx($,{condition:s&&(o||!a),text:"Submit",onClick:c})]})}function os(){return e.jsxs("div",{children:[e.jsx("h1",{children:"Page not found"}),e.jsx("p",{children:"Sorry! We couldn't find the page you requested."})]})}function ns(){const t=N(),s=f(n=>n.user);return u.useEffect(()=>{t(x.getUser())},[t]),e.jsx(Ht,{children:e.jsxs(He,{children:[e.jsx(I,{exact:!0,path:"/",element:e.jsx(Kt,{})}),e.jsx(I,{exact:!0,path:"/species/details/:id",element:e.jsx(Z,{isReaction:!1})}),e.jsx(I,{exact:!0,path:"/reaction/details/:id",element:e.jsx(Z,{isReaction:!0})}),e.jsx(I,{exact:!0,path:"/login/:mode?",element:s?e.jsx(ze,{to:"/"}):e.jsx(zt,{})}),s&&e.jsx(I,{exact:!0,path:"/submit",element:e.jsx(ss,{})}),e.jsx(I,{path:"*",element:e.jsx(os,{})})]})})}Oe.createRoot(document.getElementById("root")).render(e.jsx(Le.StrictMode,{children:e.jsx($e,{children:e.jsx(De,{store:ft,children:e.jsx(ns,{})})})}));
